// åº”ç”¨é…ç½®ç®¡ç† - ç»Ÿä¸€ç®¡ç†æ‰€æœ‰é…ç½®é¡¹
// ğŸ¯ è®¾è®¡ç†å¿µï¼šå°†æ‰€æœ‰é…ç½®é›†ä¸­ç®¡ç†ï¼Œé¿å…åˆ†æ•£åœ¨å„ä¸ªæ–‡ä»¶ä¸­é€ æˆç»´æŠ¤å›°éš¾
const AppConfig = {
    // åº”ç”¨åŸºç¡€é…ç½®
    app: {
        name: 'è¥¿æ¸¸è¯†å­—2500',        // åº”ç”¨åç§°ï¼Œç”¨äºæ˜¾ç¤ºå’Œæ ‡è¯†
        version: '0.2',             // ç‰ˆæœ¬å·ï¼Œç”¨äºç‰ˆæœ¬ç®¡ç†å’Œç¼“å­˜æ§åˆ¶
        debug: false                // è°ƒè¯•æ¨¡å¼å¼€å…³ï¼Œæ§åˆ¶æ˜¯å¦è¾“å‡ºè°ƒè¯•ä¿¡æ¯
    },

    // æ¸¸æˆé…ç½® - æ§åˆ¶æ ¸å¿ƒç©æ³•å‚æ•°
    game: {
        charactersPerLevel: 10,     // æ¯å…³å­¦ä¹ çš„æ±‰å­—æ•°é‡ï¼Œå½±å“å­¦ä¹ å¼ºåº¦
        maxLevels: 50,              // æœ€å¤§å…³å¡æ•°ï¼Œå†³å®šæ¸¸æˆå†…å®¹æ€»é‡
        timePerCharacter: 2,        // æ¯ä¸ªæ±‰å­—çš„é¢„æœŸå­¦ä¹ æ—¶é—´(åˆ†é’Ÿ)ï¼Œç”¨äºè¿›åº¦ä¼°ç®—
        maxLives: 3,                // æœ€å¤§ç”Ÿå‘½å€¼ï¼Œå½±å“æ¸¸æˆéš¾åº¦å’Œå®¹é”™æ€§
        scorePerCorrect: 1          // ç­”å¯¹ä¸€é¢˜çš„å¾—åˆ†ï¼Œä¿æŒç®€å•çš„1åˆ†åˆ¶
    },

    // AIè©æç³»ç»Ÿé…ç½® - æ™ºèƒ½å­¦ä¹ ç®—æ³•çš„æ ¸å¿ƒå‚æ•°
    ai: {
        // æ—¶é—´ç›¸å…³é…ç½®
        responseTimeThreshold: 5000,        // å“åº”æ—¶é—´é˜ˆå€¼(æ¯«ç§’)ï¼Œè¶…è¿‡æ­¤æ—¶é—´è®¤ä¸ºå­¦ä¹ è€…æœ‰å›°éš¾
        reviewCheckInterval: 60 * 60 * 1000, // å¤ä¹ æ£€æŸ¥é—´éš”(1å°æ—¶)ï¼Œå®šæœŸæ£€æŸ¥æ˜¯å¦éœ€è¦å¤ä¹ 

        // ç®—æ³•å‚æ•° - ç”¨äºè¯„ä¼°å­¦ä¹ è€…çš„æŒæ¡ç¨‹åº¦
        frequencyNormalizationFactor: 100000000,  // è¯é¢‘å½’ä¸€åŒ–å› å­ï¼Œç”¨äºå¹³è¡¡é«˜é¢‘è¯å’Œä½é¢‘è¯çš„æƒé‡
        highCorrectRateThreshold: 0.8,           // é«˜æ­£ç¡®ç‡é˜ˆå€¼ï¼Œè¾¾åˆ°æ­¤å€¼è®¤ä¸ºæŒæ¡è‰¯å¥½
        excellentCorrectRateThreshold: 0.9,      // ä¼˜ç§€æ­£ç¡®ç‡é˜ˆå€¼ï¼Œè¾¾åˆ°æ­¤å€¼è®¤ä¸ºå®Œå…¨æŒæ¡
        poorCorrectRateThreshold: 0.6,           // è¾ƒå·®æ­£ç¡®ç‡é˜ˆå€¼ï¼Œä½äºæ­¤å€¼éœ€è¦é‡ç‚¹å¤ä¹ 
        goodCorrectRateThreshold: 0.7,           // è‰¯å¥½æ­£ç¡®ç‡é˜ˆå€¼ï¼Œä»‹äºè‰¯å¥½å’Œä¼˜ç§€ä¹‹é—´

        // æƒé‡é…ç½® - å½±å“å­¦ä¹ ä¼˜å…ˆçº§çš„è®¡ç®—
        errorWeightMultiplier: 2,               // é”™è¯¯æƒé‡å€æ•°ï¼Œé”™è¯¯çš„æ±‰å­—ä¼šè·å¾—æ›´é«˜çš„å¤ä¹ ä¼˜å…ˆçº§
        maxTimeWeight: 2,                       // æœ€å¤§æ—¶é—´æƒé‡ï¼Œå“åº”æ—¶é—´è¿‡é•¿çš„æ±‰å­—æƒé‡å¢åŠ 

        // å­¦ä¹ ç›¸å…³é…ç½®
        defaultLearningCount: 10,               // é»˜è®¤å­¦ä¹ æ•°é‡ï¼Œæ¯æ¬¡å­¦ä¹ çš„æ±‰å­—ä¸ªæ•°
        maxReviewCharacters: 5,                 // æœ€å¤§å¤ä¹ æ±‰å­—æ•°ï¼Œé¿å…å¤ä¹ è´Ÿæ‹…è¿‡é‡
        timePerReviewChar: 2,                   // æ¯ä¸ªå¤ä¹ æ±‰å­—çš„é¢„æœŸæ—¶é—´(åˆ†é’Ÿ)
        timePerNewChar: 3,                      // æ¯ä¸ªæ–°æ±‰å­—çš„é¢„æœŸå­¦ä¹ æ—¶é—´(åˆ†é’Ÿ)

        // è‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿é…ç½® - åŸºäºç§‘å­¦çš„è®°å¿†è§„å¾‹
        forgettingCurve: {
            // å¤ä¹ æ—¶é—´ç‚¹(å°æ—¶)ï¼š1å°æ—¶ã€9å°æ—¶ã€1å¤©ã€3å¤©ã€1å‘¨ã€1æœˆ
            // ğŸ§  ç§‘å­¦ä¾æ®ï¼šæ ¹æ®è‰¾å®¾æµ©æ–¯é—å¿˜æ›²çº¿ç†è®ºï¼Œè¿™äº›æ˜¯è®°å¿†å·©å›ºçš„å…³é”®æ—¶é—´ç‚¹
            reviewPoints: [1, 9, 24, 72, 168, 720],
            // å¯¹åº”æ—¶é—´ç‚¹çš„è®°å¿†ä¿æŒç‡ï¼Œç”¨äºè®¡ç®—å¤ä¹ ä¼˜å…ˆçº§
            // ğŸ“Š æ•°æ®æ¥æºï¼šè‰¾å®¾æµ©æ–¯å®éªŒæ•°æ®ï¼Œéšæ—¶é—´é€’å‡çš„è®°å¿†ä¿æŒç‡
            retentionRates: [0.58, 0.44, 0.36, 0.28, 0.25, 0.21]
        }
    },

    // è¯­éŸ³ç³»ç»Ÿé…ç½® - æ§åˆ¶æ±‰å­—å‘éŸ³çš„å‚æ•°
    speech: {
        volume: 1.0,                // éŸ³é‡(0-1)ï¼Œ1.0ä¸ºæœ€å¤§éŸ³é‡ç¡®ä¿æ¸…æ™°åº¦
        rate: 0.6,                  // è¯­é€Ÿ(0.1-10)ï¼Œ0.6ä¸ºè¾ƒæ…¢è¯­é€Ÿï¼Œé€‚åˆå„¿ç«¥å­¦ä¹ æ‹¼éŸ³
        pitch: 1.0,                 // éŸ³è°ƒ(0-2)ï¼Œ1.0ä¸ºæ ‡å‡†éŸ³è°ƒ
        // é¦–é€‰è¯­éŸ³å¼•æ“åˆ—è¡¨ - æŒ‰ä¼˜å…ˆçº§æ’åºï¼Œç¡®ä¿åœ¨ä¸åŒè®¾å¤‡ä¸Šéƒ½èƒ½æ‰¾åˆ°åˆé€‚çš„ä¸­æ–‡è¯­éŸ³
        preferredVoices: [
            'Microsoft Yaoyao Desktop - Chinese (Simplified, PRC)',    // å¾®è½¯é›…é›…ï¼ˆæ¡Œé¢ç‰ˆï¼‰
            'Microsoft Kangkang Desktop - Chinese (Simplified, PRC)',  // å¾®è½¯åº·åº·ï¼ˆæ¡Œé¢ç‰ˆï¼‰
            'Microsoft Huihui Desktop - Chinese (Simplified, PRC)',    // å¾®è½¯æ…§æ…§ï¼ˆæ¡Œé¢ç‰ˆï¼‰
            'Chinese (China)'                                          // é€šç”¨ä¸­æ–‡è¯­éŸ³ï¼ˆå…œåº•é€‰é¡¹ï¼‰
        ]
    },

    // æ•°æ®æ–‡ä»¶è·¯å¾„é…ç½® - ç»Ÿä¸€ç®¡ç†æ•°æ®æ–‡ä»¶ä½ç½®
    data: {
        charactersFile: './data/chinaword2500.json',    // æ±‰å­—æ•°æ®åº“æ–‡ä»¶ï¼ŒåŒ…å«2500ä¸ªå¸¸ç”¨æ±‰å­—
        storiesFile: './data/stories.json'              // è¥¿æ¸¸è®°æ•…äº‹æ¨¡æ¿æ–‡ä»¶ï¼Œç”¨äºç”Ÿæˆå…³å¡
    },

    // å­˜å‚¨é”®åé…ç½® - ç»Ÿä¸€ç®¡ç†localStorageçš„é”®åï¼Œé¿å…é”®åå†²çª
    storage: {
        userProfile: 'aiPutiUserProfile',       // ç”¨æˆ·æ¡£æ¡ˆæ•°æ®ï¼ŒåŒ…å«å­¦ä¹ åå¥½å’ŒåŸºæœ¬ä¿¡æ¯
        learningData: 'aiPutiLearningData',     // å­¦ä¹ æ•°æ®ï¼ŒåŒ…å«æ¯ä¸ªæ±‰å­—çš„å­¦ä¹ è®°å½•
        gameProgress: 'gameProgress',           // æ¸¸æˆè¿›åº¦ï¼ŒåŒ…å«å…³å¡å®Œæˆæƒ…å†µå’Œå¾—åˆ†
        settings: 'userSettings'                // ç”¨æˆ·è®¾ç½®ï¼ŒåŒ…å«éŸ³é‡ã€è¯­é€Ÿç­‰ä¸ªæ€§åŒ–é…ç½®
    },

    // UIé…ç½® - æ§åˆ¶ç”¨æˆ·ç•Œé¢çš„äº¤äº’ä½“éªŒ
    ui: {
        animationDuration: 300,                 // åŠ¨ç”»æŒç»­æ—¶é—´(æ¯«ç§’)ï¼Œå½±å“ç•Œé¢åˆ‡æ¢çš„æµç•…åº¦
        toastDuration: 3000,                    // æç¤ºæ¶ˆæ¯æ˜¾ç¤ºæ—¶é—´(æ¯«ç§’)ï¼Œå½±å“ç”¨æˆ·åé¦ˆçš„å¯è§æ€§
        mobileBreakpoint: 768                   // ç§»åŠ¨ç«¯æ–­ç‚¹(åƒç´ )ï¼Œç”¨äºå“åº”å¼è®¾è®¡çš„å±å¹•å°ºå¯¸åˆ¤æ–­
    },

    // å¼€å‘é…ç½® - ä»…åœ¨å¼€å‘é˜¶æ®µä½¿ç”¨çš„é…ç½®
    dev: {
        enableConsoleLog: true,                 // æ˜¯å¦å¯ç”¨æ§åˆ¶å°æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•
        enablePerformanceMonitoring: false,    // æ˜¯å¦å¯ç”¨æ€§èƒ½ç›‘æ§ï¼Œç”¨äºæ€§èƒ½åˆ†æ
        mockDataEnabled: false                  // æ˜¯å¦å¯ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œç”¨äºç¦»çº¿å¼€å‘æµ‹è¯•
    }
};

// ğŸ”§ ç¯å¢ƒé…ç½®è¦†ç›– - æ ¹æ®è¿è¡Œç¯å¢ƒè‡ªåŠ¨è°ƒæ•´é…ç½®
// æ£€æµ‹å¼€å‘ç¯å¢ƒï¼šæœ¬åœ°ä¸»æœºæˆ–æ–‡ä»¶åè®®
if (window.location.hostname === 'localhost' || window.location.protocol === 'file:') {
    AppConfig.dev.enableConsoleLog = true;     // å¼€å‘ç¯å¢ƒè‡ªåŠ¨å¯ç”¨æ—¥å¿—
    AppConfig.app.debug = true;                // å¼€å‘ç¯å¢ƒè‡ªåŠ¨å¯ç”¨è°ƒè¯•æ¨¡å¼
}

// ğŸ›¡ï¸ é…ç½®éªŒè¯å‡½æ•° - ç¡®ä¿åº”ç”¨å¯åŠ¨æ—¶æ‰€æœ‰å¿…è¦é…ç½®éƒ½å­˜åœ¨
const validateConfig = () => {
    // å®šä¹‰å¿…é¡»å­˜åœ¨çš„é…ç½®æ¨¡å—
    const required = ['app', 'game', 'ai', 'speech', 'data', 'storage'];

    // é€ä¸€æ£€æŸ¥æ¯ä¸ªå¿…è¦é…ç½®æ¨¡å—
    for (const key of required) {
        if (!AppConfig[key]) {
            // å¦‚æœç¼ºå°‘é…ç½®ï¼ŒæŠ›å‡ºé”™è¯¯é˜»æ­¢åº”ç”¨å¯åŠ¨
            throw new Error(`ç¼ºå°‘å¿…è¦é…ç½®: ${key}`);
        }
    }
    console.log('âœ… é…ç½®éªŒè¯é€šè¿‡');
};

// ğŸ” è·å–é…ç½®çš„è¾…åŠ©å‡½æ•° - æ”¯æŒç‚¹å·è·¯å¾„è®¿é—®åµŒå¥—é…ç½®
// ä½¿ç”¨ç¤ºä¾‹ï¼šgetConfig('ai.forgettingCurve.reviewPoints')
const getConfig = (path) => {
    const keys = path.split('.');           // å°†è·¯å¾„æŒ‰ç‚¹å·åˆ†å‰²æˆæ•°ç»„
    let value = AppConfig;                  // ä»æ ¹é…ç½®å¯¹è±¡å¼€å§‹

    // é€å±‚æ·±å…¥è®¿é—®åµŒå¥—å±æ€§
    for (const key of keys) {
        value = value[key];
        if (value === undefined) {
            // å¦‚æœè·¯å¾„ä¸å­˜åœ¨ï¼Œè®°å½•è­¦å‘Šå¹¶è¿”å›null
            console.warn(`é…ç½®è·¯å¾„ä¸å­˜åœ¨: ${path}`);
            return null;
        }
    }
    return value;                           // è¿”å›æ‰¾åˆ°çš„é…ç½®å€¼
};

// ğŸŒ å¯¼å‡ºé…ç½®åˆ°å…¨å±€ä½œç”¨åŸŸ - ä½¿æ•´ä¸ªåº”ç”¨éƒ½èƒ½è®¿é—®é…ç½®
window.AppConfig = AppConfig;               // å¯¼å‡ºå®Œæ•´é…ç½®å¯¹è±¡
window.getConfig = getConfig;               // å¯¼å‡ºé…ç½®è®¿é—®å‡½æ•°

// ğŸš€ åˆå§‹åŒ–æ—¶éªŒè¯é…ç½® - ç¡®ä¿åº”ç”¨å¯åŠ¨å‰é…ç½®å®Œæ•´
validateConfig();
